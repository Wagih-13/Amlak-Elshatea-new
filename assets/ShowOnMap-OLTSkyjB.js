import{r as p,u as b,j as a,L as R,C as S,c as F,F as A}from"./index-bhfotHN7.js";import{u as D,F as $,S as B}from"./SearchSortAndFilter-kczINux3.js";import{u as O}from"./UnitDetails-TXyzZKhi.js";import{c as z,l as V,d as Z,M as H,T as _,a as q,b as K}from"./MarkerIcon-Qt1AfLDv.js";import{u as G}from"./useUnitRating-UvJBESCJ.js";import{a as L}from"./hooks-S2a1xkub.js";import"./useUrlPosition-WXTrdwL1.js";import"./useQuery-nOnw8WVp.js";import"./index.es-44rdKnfN.js";import"./index-5OaO6oW1.js";import"./web-y2TqyTqE.js";const I=z(function(e,l){const r=new V.Tooltip(e,l.overlayContainer);return Z(r,l)},function(e,l,{position:r},m){p.useEffect(function(){const i=l.overlayContainer;if(i==null)return;const{instance:c}=e,h=u=>{u.tooltip===c&&(r!=null&&c.setLatLng(r),c.update(),m(!0))},d=u=>{u.tooltip===c&&m(!1)};return i.on({tooltipopen:h,tooltipclose:d}),i.bindTooltip(c),function(){i.off({tooltipopen:h,tooltipclose:d}),i._map!=null&&i.unbindTooltip()}},[e,l,m,r])}),J=({unit:s,focusUnit:e,className:l=""})=>{const[r]=b(),m=new Date;new Date().setDate(m.getDate()+1);const{UnitStars:i}=G(s.areaUnitAvgRating),c=+s.areaUnitPrice;return a.jsxs("div",{className:`flex h-full shrink-0 grow-0 basis-[400px] items-center justify-center shadow-lg lg:h-auto lg:basis-[200px] ${l}`,children:[a.jsx("div",{className:"h-full basis-[40%]",children:a.jsx("img",{className:"size-full max-h-[200px] cursor-pointer rounded-s-2xl object-cover",src:s.areaUnitMainPhoto,onClick:e})}),a.jsxs("div",{className:"flex h-full flex-1 basis-[60%] flex-col justify-between rounded-e-2xl bg-[var(--white-color)] p-4 dark:bg-[var(--main-dark)] dark:text-[var(--white-color)]",children:[a.jsxs(R,{to:`/search-unit/${s.areaUnitCode}`,className:"flex w-full flex-col gap-y-2",children:[a.jsx("h1",{children:s.areaUnitName}),a.jsx("span",{children:s.areaUnitAddress}),a.jsxs("div",{className:"flex gap-2 font-normal",children:[c,a.jsxs("span",{className:"text-[#9B9B9B]",children:[" ",r("unitDetail.left-aside.night")]})]})]}),a.jsx("div",{className:"flex items-center justify-between gap-[0.5ch] py-6 ps-5",children:a.jsx(i,{})})]})]})},C=[23.8725553,34.4324585];function y(s){return s!=null&&s.includes(", ")&&s.split(", ").length===2?s.split(", ").map(e=>+e):C}const ce=()=>{const[s]=b(),[e]=S(),{unitId:l}=F(),{unitDetails:r}=O(),{searchResults:m,loadingSearchResults:x}=D(),[i,c]=p.useState(5),[h,d]=p.useState(null),[u,j]=p.useState(void 0),w=p.useRef(null),v=m??[],N=Math.min(...v.map(t=>+t.areaUnitPrice)),T=Math.max(...v.map(t=>+t.areaUnitPrice)),P={minPrice:+(e.get("minPrice")??`${N}`),maxPrice:+(e.get("maxPrice")??`${T}`),minCapacity:+(e.get("minCapacity")??"0"),maxCapacity:+(e.get("maxCapacity")??"-1"),minCars:+(e.get("minCars")??"0"),maxCars:+(e.get("maxCars")??"-1"),address:e.get("address")??"",areaUnitName:e.get("areaUnitName")??"",areaUnitCode:e.get("areaUnitCode")??""},M=$(v,P),E=e.get("sortBy")||"0",o=B(M,E),g=o==null?void 0:o.findIndex(t=>t.areaUnitCode===l),f=o==null?void 0:o.map(t=>y(t.areaUnitLocation)),k=t=>{var n;(n=w.current)==null||n.children[t].scrollIntoView(),d(t)};return p.useEffect(()=>{var t;g>-1&&f?(j(f[g]),(t=w.current)==null||t.children[g].scrollIntoView()):r!=null&&r.areaUnitLocation&&j(y(r==null?void 0:r.areaUnitLocation)),c(15)},[o,r==null?void 0:r.areaUnitLocation,g]),p.useEffect(()=>{const t=document.querySelector(".footer-container");return console.log(t),t&&t.classList.add("!hidden"),()=>t==null?void 0:t.classList.remove("!hidden")},[]),a.jsxs(a.Fragment,{children:[x&&a.jsx(A,{}),!x&&a.jsxs("div",{className:"m-8 mt-24 flex h-[100dvh] flex-col gap-4 lg:m-0 lg:flex-row lg:justify-between",children:[a.jsx("div",{ref:w,className:"flex shrink-0 basis-[200px] flex-row gap-4 overflow-y-hidden overflow-x-scroll pb-4 lg:basis-[400px] lg:flex-col lg:overflow-x-auto lg:overflow-y-scroll lg:px-4",children:o==null?void 0:o.map((t,n)=>a.jsx(J,{unit:t,focusUnit:()=>{j(f[n]),d(n)},className:h===n?"border-[2px] border-green-600 rounded-2xl shadow-lg":""},n))}),a.jsx("div",{className:"basis-full",children:o&&a.jsxs(H,{center:u??C,zoom:5,style:{height:"100%",width:"100%"},children:[a.jsx(_,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),f==null?void 0:f.map((t,n)=>{var U;return a.jsx(q,{eventHandlers:{click:()=>k(n)},position:t,icon:K,children:a.jsx(I,{direction:"top",className:"text-lg",offset:[75,-5],opacity:1,permanent:!0,children:`${(U=o==null?void 0:o[n])==null?void 0:U.areaUnitPrice} ${s("unitDetail.left-aside.night")}`})},n)}),a.jsx(Q,{pos:u??C}),a.jsx(W,{zoom:i})]})})]})]})},Q=({pos:s})=>{const e=L();return p.useEffect(()=>{e.setView(s)},[e,s]),null},W=({zoom:s=5})=>{const e=L();return p.useEffect(()=>{e.setZoom(s)},[e,s]),null};export{ce as default};
