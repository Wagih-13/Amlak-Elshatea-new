import{r as p,u as N,j as e,L as S,C as B,d as D,F as $}from"./index-UIuYEt_z.js";import{u as F,F as A,S as O}from"./SearchSortAndFilter-8U4LvRCN.js";import{a as z,u as I}from"./UnitDetails-Sz3PlQ1s.js";import{c as V,l as Z,d as H,M as _,T as q,a as K,b as G}from"./MarkerIcon-mEe1B5bc.js";import{u as J}from"./useUnitRating-ptpjBbi-.js";import{P as Q,a as L}from"./Popup-0flBtsig.js";import"./useUrlPosition-A257oiwN.js";import"./useQuery-_5io8ruZ.js";import"./index.es-UzAdvkII.js";import"./index-5OaO6oW1.js";import"./web-_NfIImOP.js";const W=V(function(t,l){const r=new Z.Tooltip(t,l.overlayContainer);return H(r,l)},function(t,l,{position:r},d){p.useEffect(function(){const n=l.overlayContainer;if(n==null)return;const{instance:c}=t,m=u=>{u.tooltip===c&&(r!=null&&c.setLatLng(r),c.update(),d(!0))},x=u=>{u.tooltip===c&&d(!1)};return n.on({tooltipopen:m,tooltipclose:x}),n.bindTooltip(c),function(){n.off({tooltipopen:m,tooltipclose:x}),n._map!=null&&n.unbindTooltip()}},[t,l,d,r])}),X=({unit:a,focusUnit:t,className:l=""})=>{const[r]=N(),d=new Date,f=new Date;f.setDate(d.getDate()+1);const{contractTotal:n}=z(d,f,a.areaUnitCode),{UnitStars:c}=J(a.areaUnitAvgRating),m=+a.areaUnitPrice;return e.jsxs("div",{className:`flex h-full shrink-0 grow-0 basis-[400px] items-center justify-center shadow-lg lg:h-auto lg:basis-[200px] ${l}`,children:[e.jsx("div",{className:"h-full basis-[40%]",children:e.jsx("img",{className:"size-full max-h-[200px] cursor-pointer rounded-s-2xl object-cover",src:a.areaUnitMainPhoto,onClick:t})}),e.jsxs("div",{className:"flex h-full flex-1 basis-[60%] flex-col justify-between rounded-e-2xl bg-[var(--white-color)] p-4 dark:bg-[var(--main-dark)] dark:text-[var(--white-color)]",children:[e.jsxs(S,{to:`/search-unit/${a.areaUnitCode}`,className:"flex w-full flex-col gap-y-2",children:[e.jsx("h1",{children:a.areaUnitName}),e.jsx("span",{children:a.areaUnitAddress}),e.jsxs("div",{className:"flex gap-2 font-normal",children:[m,e.jsxs("span",{className:"text-[#9B9B9B]",children:[" ",r("unitDetail.left-aside.night")]})]}),e.jsxs("div",{className:"font-normal text-[#9B9B9B]",children:[r("featuredUnits.total")," ( ",r("featuredUnits.singleNight")," )",(n==null?void 0:n.total)||m," ",r("unitDetail.left-aside.SR")]})]}),e.jsx("div",{className:"flex items-center justify-between gap-[0.5ch] py-6 ps-5",children:e.jsx(c,{})})]})]})},C=[23.8725553,34.4324585];function b(a){return a!=null&&a.includes(", ")&&a.split(", ").length===2?a.split(", ").map(t=>+t):C}const me=()=>{const[a]=N(),[t]=B(),{unitId:l}=D(),{unitDetails:r}=I(),{searchResults:d,loadingSearchResults:f}=F(),[n,c]=p.useState(5),[m,x]=p.useState(null),[u,j]=p.useState(void 0),U=p.useRef(null),v=d??[],P=Math.min(...v.map(s=>+s.areaUnitPrice)),T=Math.max(...v.map(s=>+s.areaUnitPrice)),M={minPrice:+(t.get("minPrice")??`${P}`),maxPrice:+(t.get("maxPrice")??`${T}`),minCapacity:+(t.get("minCapacity")??"0"),maxCapacity:+(t.get("maxCapacity")??"-1"),minCars:+(t.get("minCars")??"0"),maxCars:+(t.get("maxCars")??"-1"),address:t.get("address")??"",areaUnitName:t.get("areaUnitName")??"",areaUnitCode:t.get("areaUnitCode")??""},E=A(v,M),R=t.get("sortBy")||"0",i=O(E,R),g=i.findIndex(s=>s.areaUnitCode===l),h=i.map(s=>b(s.areaUnitLocation)),k=s=>{var o;(o=U.current)==null||o.children[s].scrollIntoView(),x(s)};return p.useEffect(()=>{var s;g>-1&&h?(j(h[g]),(s=U.current)==null||s.children[g].scrollIntoView()):r!=null&&r.areaUnitLocation&&j(b(r==null?void 0:r.areaUnitLocation)),c(15)},[i,r==null?void 0:r.areaUnitLocation,g]),p.useEffect(()=>{const s=document.querySelector(".footer-container");return console.log(s),s&&s.classList.add("!hidden"),()=>s==null?void 0:s.classList.remove("!hidden")},[]),e.jsxs(e.Fragment,{children:[f&&e.jsx($,{}),!f&&e.jsxs("div",{className:"m-8 mt-24 flex h-[100dvh] flex-col gap-4 lg:m-0 lg:flex-row lg:justify-between",children:[e.jsx("div",{ref:U,className:"flex shrink-0 basis-[200px] flex-row gap-4 overflow-y-hidden overflow-x-scroll pb-4 lg:basis-[400px] lg:flex-col lg:overflow-x-auto lg:overflow-y-scroll lg:px-4",children:i.map((s,o)=>e.jsx(X,{unit:s,focusUnit:()=>{j(h[o]),x(o)},className:m===o?"border-[2px] border-green-600 rounded-2xl shadow-lg":""},o))}),e.jsx("div",{className:"basis-full",children:i&&e.jsxs(_,{center:u??C,zoom:5,style:{height:"100%",width:"100%"},children:[e.jsx(q,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),h==null?void 0:h.map((s,o)=>{var w,y;return e.jsxs(K,{eventHandlers:{click:()=>k(o)},position:s,icon:G,children:[e.jsx(W,{direction:"top",className:"text-lg",offset:[75,-5],opacity:1,permanent:!0,children:`${(w=i==null?void 0:i[o])==null?void 0:w.areaUnitPrice} ${a("unitDetail.left-aside.night")}`}),e.jsx(Q,{className:"text-center font-[700]",children:`${(y=i==null?void 0:i[o])==null?void 0:y.areaUnitPrice} ${a("unitDetail.left-aside.night")}`})]},o)}),e.jsx(Y,{pos:u??C}),e.jsx(ee,{zoom:n})]})})]})]})},Y=({pos:a})=>{const t=L();return p.useEffect(()=>{t.setView(a)},[t,a]),null},ee=({zoom:a=5})=>{const t=L();return p.useEffect(()=>{t.setZoom(a)},[t,a]),null};export{me as default};
