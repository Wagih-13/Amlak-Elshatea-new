import{r as c,u as b,j as a,L as R,C as S,c as F,F as A}from"./index-Sf6fg46U.js";import{u as D,F as I,S as $}from"./SearchSortAndFilter-YZljUzT0.js";import{u as B}from"./UnitDetails-oXQ1eoXl.js";import{c as O,l as z,d as V,M as Z,T as H,a as _,b as q}from"./MarkerIcon-NKZHiDB-.js";import{u as K}from"./useUnitRating-9oolTxHz.js";import{a as L}from"./hooks-U67cai-c.js";import"./useUrlPosition-svC8i8wH.js";import"./useQuery-jp5Q6j4G.js";import"./index.es--8fXy3b_.js";import"./index-5OaO6oW1.js";import"./web-XXT56KXo.js";const G=O(function(e,i){const r=new z.Tooltip(e,i.overlayContainer);return V(r,i)},function(e,i,{position:r},m){c.useEffect(function(){const n=i.overlayContainer;if(n==null)return;const{instance:l}=e,h=d=>{d.tooltip===l&&(r!=null&&l.setLatLng(r),l.update(),m(!0))},f=d=>{d.tooltip===l&&m(!1)};return n.on({tooltipopen:h,tooltipclose:f}),n.bindTooltip(l),function(){n.off({tooltipopen:h,tooltipclose:f}),n._map!=null&&n.unbindTooltip()}},[e,i,m,r])}),J=({unit:s,focusUnit:e,className:i=""})=>{const[r]=b(),m=new Date;new Date().setDate(m.getDate()+1);const{UnitStars:n}=K(s.areaUnitAvgRating),l=+s.areaUnitPrice;return a.jsxs("div",{className:`flex h-full shrink-0 grow-0 basis-[400px] items-center justify-center shadow-lg lg:h-auto lg:basis-[200px] ${i}`,children:[a.jsx("div",{className:"h-full basis-[40%]",children:a.jsx("img",{className:"size-full max-h-[200px] cursor-pointer rounded-s-2xl object-cover",src:s.areaUnitMainPhoto,onClick:e})}),a.jsxs("div",{className:"flex h-full flex-1 basis-[60%] flex-col justify-between rounded-e-2xl bg-[var(--white-color)] p-4 dark:bg-[var(--main-dark)] dark:text-[var(--white-color)]",children:[a.jsxs(R,{to:`/search-unit/${s.areaUnitCode}`,className:"flex w-full flex-col gap-y-2",children:[a.jsx("h1",{children:s.areaUnitName}),a.jsx("span",{children:s.areaUnitAddress}),a.jsxs("div",{className:"flex gap-2 font-normal",children:[l,a.jsxs("span",{className:"text-[#9B9B9B]",children:[" ",r("unitDetail.left-aside.night")]})]})]}),a.jsx("div",{className:"flex items-center justify-between gap-[0.5ch] py-6 ps-5",children:a.jsx(n,{})})]})]})},C=[23.8725553,34.4324585];function y(s){return s!=null&&s.includes(", ")&&s.split(", ").length===2?s.split(", ").map(e=>+e):C}const ce=()=>{const[s]=b(),[e]=S(),{unitId:i}=F(),{unitDetails:r}=B(),{searchResults:m,loadingSearchResults:x}=D(),[n,l]=c.useState(5),[h,f]=c.useState(null),[d,j]=c.useState(void 0),w=c.useRef(null),v=m??[],N=Math.min(...v.map(t=>+t.areaUnitPrice)),T=Math.max(...v.map(t=>+t.areaUnitPrice)),P={minPrice:+(e.get("minPrice")??`${N}`),maxPrice:+(e.get("maxPrice")??`${T}`),minCapacity:+(e.get("minCapacity")??"0"),maxCapacity:+(e.get("maxCapacity")??"-1"),minCars:+(e.get("minCars")??"0"),maxCars:+(e.get("maxCars")??"-1"),address:e.get("address")??"",areaUnitName:e.get("areaUnitName")??"",areaUnitCode:e.get("areaUnitCode")??""},M=I(v,P),E=e.get("sortBy")||"0",p=$(M,E),g=p.findIndex(t=>t.areaUnitCode===i),u=p.map(t=>y(t.areaUnitLocation)),k=t=>{var o;(o=w.current)==null||o.children[t].scrollIntoView(),f(t)};return c.useEffect(()=>{var t;g>-1&&u?(j(u[g]),(t=w.current)==null||t.children[g].scrollIntoView()):r!=null&&r.areaUnitLocation&&j(y(r==null?void 0:r.areaUnitLocation)),l(15)},[p,r==null?void 0:r.areaUnitLocation,g]),c.useEffect(()=>{const t=document.querySelector(".footer-container");return console.log(t),t&&t.classList.add("!hidden"),()=>t==null?void 0:t.classList.remove("!hidden")},[]),a.jsxs(a.Fragment,{children:[x&&a.jsx(A,{}),!x&&a.jsxs("div",{className:"m-8 mt-24 flex h-[100dvh] flex-col gap-4 lg:m-0 lg:flex-row lg:justify-between",children:[a.jsx("div",{ref:w,className:"flex shrink-0 basis-[200px] flex-row gap-4 overflow-y-hidden overflow-x-scroll pb-4 lg:basis-[400px] lg:flex-col lg:overflow-x-auto lg:overflow-y-scroll lg:px-4",children:p.map((t,o)=>a.jsx(J,{unit:t,focusUnit:()=>{j(u[o]),f(o)},className:h===o?"border-[2px] border-green-600 rounded-2xl shadow-lg":""},o))}),a.jsx("div",{className:"basis-full",children:p&&a.jsxs(Z,{center:d??C,zoom:5,style:{height:"100%",width:"100%"},children:[a.jsx(H,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),u==null?void 0:u.map((t,o)=>{var U;return a.jsx(_,{eventHandlers:{click:()=>k(o)},position:t,icon:q,children:a.jsx(G,{direction:"top",className:"text-lg",offset:[75,-5],opacity:1,permanent:!0,children:`${(U=p==null?void 0:p[o])==null?void 0:U.areaUnitPrice} ${s("unitDetail.left-aside.night")}`})},o)}),a.jsx(Q,{pos:d??C}),a.jsx(W,{zoom:n})]})})]})]})},Q=({pos:s})=>{const e=L();return c.useEffect(()=>{e.setView(s)},[e,s]),null},W=({zoom:s=5})=>{const e=L();return c.useEffect(()=>{e.setZoom(s)},[e,s]),null};export{ce as default};
