import{r as C,e as D,u as N,j as e,i as E,s as p,f as A,F as P,S as q,I as B,J as L}from"./index-UIuYEt_z.js";import O from"./Navbar-puk1C1mX.js";import $ from"./Footer-oHyyY_Su.js";import{u as y,a as w}from"./hooks-96MKY8pR.js";import{P as U}from"./index-zw25BQSK.js";import{a as S}from"./PersonInfo-xQlG72si.js";import{F as V}from"./index.es-UzAdvkII.js";import{l as M,m as z}from"./index-5OaO6oW1.js";import{u as _}from"./UnitDetails-Sz3PlQ1s.js";import{S as R}from"./SecondaryButton-sF5f5a93.js";import{M as F}from"./MainButton-7s5prsiZ.js";import{S as G}from"./Save-nDWuaNwV.js";import"./useQuery-_5io8ruZ.js";import"./HomeData-DWUqC6kp.js";import"./index-KREtgCyx.js";function I({label:a,options:t,placeholder:m,currentValue:x,setCurrentValue:i,saudiNationality:n,htmlFor:s,disabled:g=!1}){var r;const[h,u]=C.useState(!1),d=C.useRef(null),[c,b]=C.useState(((r=t.find(o=>o.code===x))==null?void 0:r.text)||""),{check:{setValue:f}}=D(),{t:v}=N(),k=C.useMemo(()=>(c==null?void 0:c.length)>0?t.filter(o=>o.text.toLowerCase().includes(c==null?void 0:c.toLowerCase())):t,[t,c]),j=o=>{f(!1),i(o.code),u(!1)};return C.useEffect(()=>{const o=l=>{var T;(T=d==null?void 0:d.current)!=null&&T.contains(l.target)||u(!1)};return window.addEventListener("click",o),()=>{window.removeEventListener("click",o)}},[]),C.useEffect(()=>{var o;b(((o=t.find(l=>l.code===x))==null?void 0:o.text)||"")},[t,x]),e.jsx(e.Fragment,{children:e.jsxs("div",{ref:d,className:"relative flex w-full flex-col",children:[e.jsx("label",{className:"dark:text-[var(--white-color)]",htmlFor:s,children:a}),e.jsxs("div",{className:`flex-1 flex  items-center justify-between ${g?"cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx("input",{type:"text",required:!0,id:s,value:(n===!0&&t.length>5?v("booking_confirmation.saudiNationality"):c)||"",onChange:o=>{b(o.target.value)},placeholder:m,className:"mt-1 phoneInputBox w-full rounded-md border p-2 disabled:cursor-not-allowed dark:text-[var(--primary-color)] dark:disabled:bg-[var(--main-dark)] ",onClick:()=>u(!0),disabled:g}),e.jsx(V,{className:"absolute end-3 top-10",icon:h?M:z,onClick:()=>!g&&u(o=>!o)})]}),h&&e.jsx("ul",{className:"absolute bottom-0 z-50 w-full translate-y-full overflow-hidden rounded-[1rem] border bg-white shadow-md ",id:"nationalityList",children:k.map((o,l)=>e.jsx("li",{onClick:()=>{j(o)},className:"cursor-pointer px-4 py-2 hover:bg-gray-200",children:o.text},l))})]})})}const J=()=>{const{t:a}=N(),t=y(),{data:{countryCode:m,currentPhoneNumber:x}}=E(),{renterInfo:i}=S(x),{contractData:n}=w(d=>d.webcontract),s=((i==null?void 0:i.generalNationality)??[]).map(d=>({code:d.generalNationalityCode,text:d.generalNationalityName})),{check:{value:g,setValue:h}}=D(),u=d=>{d.target.value[0]==="1"?h(!0):h(!1),t(p({renterIDNo:d.target.value}))};return e.jsxs("div",{className:"details-grid gap-5 py-10",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"phone",className:"mb-1 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.tenant_phone")}),e.jsx(U,{placeholder:a("booking_confirmation.enter_phone"),value:`+${m}${x}`||"",defaultCountry:"SA",className:"rtl:flex-row-reverse ",international:!1,onChange:()=>{},disabled:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"TenantID",className:"mb-1 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.tenant_id")}),e.jsx("input",{type:"text",required:!0,id:"TenantID",name:"TenantID",value:(n==null?void 0:n.renterIDNo)||"",onChange:u,placeholder:a("booking_confirmation.enter_id"),className:"flex-1 rounded-md border p-2 disabled:cursor-not-allowed dark:text-[var(--primary-color)] dark:disabled:bg-[var(--main-dark)] phoneInputBox"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"Name",className:"mb-1 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.tenant_name")}),e.jsx("input",{type:"text",required:!0,id:"Name",name:"Name",value:(n==null?void 0:n.renterName)||"",onChange:d=>t(p({renterName:d.target.value})),placeholder:a("booking_confirmation.enter_name"),className:"flex-1 phoneInputBox rounded-md border p-2 disabled:cursor-not-allowed dark:text-[var(--primary-color)] dark:disabled:bg-[var(--main-dark)]"})]}),e.jsx(I,{saudiNationality:g,options:s,currentValue:(n==null?void 0:n.renterNationalityCode)||"",setCurrentValue:d=>t(p({renterNationalityCode:d.toString()})),label:a("booking_confirmation.tenant_nationality"),placeholder:a("booking_confirmation.tenant_nationality"),htmlFor:"tenantNationality"})]})},W=()=>{const{t:a}=N(),t=y(),{contractData:m}=w(r=>r.webcontract),{unitDetails:x}=_(m.areaUnitCode),{data:{currentPhoneNumber:i}}=E(),{renterInfo:n}=S(i),s=m.areaUnitContractEscort,g=((n==null?void 0:n.generalNationality)??[]).map(r=>({code:r.generalNationalityCode,text:r.generalNationalityName})),h=((n==null?void 0:n.generalRelation)??[]).map(r=>({code:r.generalRelationCode,text:r.generalRelationName})),u=+((x==null?void 0:x.areaUnitCapacity)||"1"),d=s.length>0?u-s.length:u,c=()=>{d>0&&t(p({areaUnitContractEscort:[...s,{areaUnitContractEscortID:s.length,areaUnitContractEscortCode:"",areaUnitContractCode:"",escortIDNo:"",escortName:"",escortRelation:"",escortNationality:""}]}))},b=r=>{s.length!==0&&t(p({areaUnitContractEscort:s.filter(o=>o.areaUnitContractEscortID!==r)}))},f=(r,o)=>{t(p({areaUnitContractEscort:s.map(l=>l.areaUnitContractEscortID===o?{...l,escortName:r}:l)}))},v=(r,o)=>{t(p({areaUnitContractEscort:s.map(l=>l.areaUnitContractEscortID===o?{...l,escortIDNo:r}:l)}))},k=(r,o)=>{t(p({areaUnitContractEscort:s.map(l=>l.areaUnitContractEscortID===o?{...l,escortRelation:r.toString()}:l)}))},j=(r,o)=>{t(p({areaUnitContractEscort:s.map(l=>l.areaUnitContractEscortID===o?{...l,escortNationality:r.toString()}:l)}))};return e.jsx("div",{className:"mt-5 w-full py-10",children:u>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"mb-3 text-xl font-bold dark:text-[var(--white-color)]",children:[a("booking_confirmation.escort_details")," ",e.jsxs("span",{className:"ms-4 text-[1.25rem] italic text-[var(--primary-color)]",children:["( ",u-d," / ",u," )"]})]}),e.jsx("div",{className:"flex w-full flex-wrap items-start justify-between",children:s.map((r,o)=>e.jsxs("div",{className:"details-grid w-full gap-4 pb-5 md:gap-8",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-1 dark:text-[var(--white-color)]",children:a("booking_confirmation.name_utility")}),e.jsx("input",{type:"text",required:!0,className:"rounded border p-2 disabled:cursor-not-allowed dark:text-[var(--black-color)] dark:disabled:bg-[var(--main-dark)]",placeholder:a("booking_confirmation.enter_name_utility"),value:r.escortName,onChange:l=>f(l.target.value,r.areaUnitContractEscortID)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-1 dark:text-[var(--white-color)]",children:a("booking_confirmation.id_no_utility")}),e.jsx("input",{type:"text",required:!0,className:"rounded border p-2 disabled:cursor-not-allowed dark:text-[var(--black-color)] dark:disabled:bg-[var(--main-dark)]",placeholder:a("booking_confirmation.enter_id_no_utility"),value:r.escortIDNo,onChange:l=>{v(l.target.value,r.areaUnitContractEscortID)}})]}),e.jsx(I,{saudiNationality:!1,options:h,currentValue:r.escortRelation,setCurrentValue:l=>k(l,r.areaUnitContractEscortID),label:a("booking_confirmation.kinship_utility"),placeholder:a("booking_confirmation.enter_kinship_utility"),htmlFor:"escortRelation"}),e.jsx(I,{saudiNationality:!1,options:g,currentValue:r.escortNationality,setCurrentValue:l=>j(l,r.areaUnitContractEscortID),label:a("booking_confirmation.escort_nationality"),placeholder:a("booking_confirmation.escort_nationality"),htmlFor:"escortNationality"}),s.length!==0&&e.jsx("div",{className:"mt-6",onClick:()=>b(r.areaUnitContractEscortID),children:e.jsx(R,{children:a("booking_confirmation.remove")})})]},o))}),d>0&&e.jsx(F,{className:"mt-6",onClick:c,children:a("booking_confirmation.add")})]})})},H=()=>{const{t:a}=N(),t=y(),{contractData:m}=w(c=>c.webcontract),{unitDetails:x}=_(m.areaUnitCode),i=m.areaUnitContractCar,n=+((x==null?void 0:x.areaUnitCarsNo)||"1"),s=i.length>0?n-i.length:n,g=()=>{s>0&&t(p({areaUnitContractCar:[...i,{areaUnitContractCarID:i.length,areaUnitContractCarCode:"",areaUnitContractCode:"",carType:"",carNo:""}]}))},h=c=>{i.length!==0&&t(p({areaUnitContractCar:i.filter(b=>b.areaUnitContractCarID!==c)}))},u=(c,b)=>{t(p({areaUnitContractCar:i.map(f=>f.areaUnitContractCarID!==b?f:{...f,carType:c.target.value})}))},d=(c,b)=>{t(p({areaUnitContractCar:i.map(f=>f.areaUnitContractCarID!==b?f:{...f,carNo:c.target.value})}))};return e.jsx("div",{className:"w-full pb-5",children:n>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"pb-3 text-[24px] font-bold dark:text-[var(--white-color)]",children:[a("booking_confirmation.car_data")," ",e.jsxs("span",{className:"ms-4 text-[1.25rem] italic text-[var(--primary-color)]",children:["( ",n-s," / ",n," )"]})]}),e.jsx("hr",{}),e.jsx("div",{className:"flex flex-wrap items-start gap-2 pt-10 md:items-center",children:i.map((c,b)=>e.jsxs("div",{className:"flex w-full flex-wrap justify-start gap-8 pb-5",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-1 block dark:text-[var(--white-color)]",children:a("booking_confirmation.car_type")}),e.jsx("input",{type:"text",required:!0,className:"mb-2 h-[40px] w-[300px] rounded border px-2 py-1 disabled:cursor-not-allowed dark:text-[var(--black-color)] dark:disabled:bg-[var(--main-dark)] lg:w-[200px]",placeholder:a("booking_confirmation.enter_car_type"),value:c.carType,onChange:f=>u(f,c.areaUnitContractCarID)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-1 block dark:text-[var(--white-color)]",children:a("booking_confirmation.car_palte_no")}),e.jsx("input",{type:"text",required:!0,className:"mb-2 h-[40px] w-[300px] rounded border px-2 py-1 disabled:cursor-not-allowed dark:text-[var(--black-color)] dark:disabled:bg-[var(--main-dark)] lg:w-[200px]",placeholder:a("booking_confirmation.enter_car_palte_no"),value:c.carNo,onChange:f=>d(f,c.areaUnitContractCarID)})]}),i.length!==0&&e.jsx("div",{className:"mt-6",onClick:()=>h(c.areaUnitContractCarID),children:e.jsx(R,{children:a("booking_confirmation.remove")})})]},b))}),s>0&&e.jsx(F,{className:"mt-0 lg:-mt-[9px]",onClick:g,children:a("booking_confirmation.add")})]})})},K=()=>{const{t:a}=N(),t=y(),{contractData:m}=w(n=>n.webcontract),x=n=>{t(p({renterIDNo:n.target.value}))},{unitDetails:i}=_();return console.log(i),e.jsxs("div",{className:"details-grid gap-5 py-10",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"TenantID",className:"mb-3 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.unit_code")}),e.jsx("input",{type:"text",required:!0,id:"TenantID",name:"TenantID",value:(i==null?void 0:i.areaUnitName)||"",onChange:x,disabled:!0,className:"flex-1 rounded-md  p-2 disabled:cursor-not-allowed dark:text-[var(--primary-color)] dark:disabled:bg-[var(--main-dark)] "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"TenantID",className:"mb-3 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.DateOfArrival")}),e.jsx("input",{type:"text",required:!0,id:"TenantID",name:"TenantID",value:new Date(m==null?void 0:m.checkInDate).toLocaleDateString()||"",onChange:x,disabled:!0,className:"flex-1 rounded-md  p-2 disabled:cursor-not-allowed  dark:text-[var(--primary-color)]  dark:disabled:bg-[var(--main-dark)]  "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"Name",className:"mb-3 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.DateOfDeparture")}),e.jsx("input",{type:"text",required:!0,id:"Name",name:"Name",value:new Date(m==null?void 0:m.checkOutDate).toLocaleDateString()||"",onChange:n=>t(p({renterName:n.target.value})),disabled:!0,className:"flex-1  rounded-md  p-2 disabled:cursor-not-allowed dark:text-[var(--primary-color)] dark:disabled:bg-[var(--main-dark)] "})]})]})},Q=(a,t)=>{var m,x;return{areaUnitContractEscortID:t,areaUnitContractEscortCode:(m=a.areaUnitContractCode)==null?void 0:m.toString(),areaUnitContractCode:(x=a.areaUnitContractCode)==null?void 0:x.toString(),escortIDNo:a.escortIDNo,escortName:a.escortName,escortRelation:a.escortRelationCode,escortNationality:a.escortNationalityCode}},X=a=>({areaUnitContractCarID:a.areaUnitContractCarID,areaUnitContractCarCode:a.areaUnitContractCarCode,areaUnitContractCode:a.areaUnitContractCode,carType:a.carType,carNo:a.carNo}),he=()=>{const{t:a}=N(),{unitDetails:t}=_(),m=y(),{contractData:x,status:i}=w(r=>r.webcontract),{data:{verificationCode:n,currentPhoneNumber:s,countryCode:g}}=E(),{renterInfo:h,loadingRenterInfo:u}=S(s),[d,c]=C.useState(!1),b=()=>{m(B(x))},f=()=>{k(!1),m(L()),j("/")},{last:{value:v,setValue:k}}=D(),j=A();return C.useEffect(()=>{h&&m(p({renterMobile:s,renterCountryCode:`+${g}`,verificationCode:n,renterIDNo:h.areaUnitContract.renterIDNo,renterName:h.areaUnitContract.renterName,renterNationalityCode:h.areaUnitContract.renterNationalityCode,areaUnitContractEscort:(h.unitContractEscortList||[]).map((r,o)=>Q(r,o)).slice(0,+((t==null?void 0:t.areaUnitCapacity)||"1")),areaUnitContractCar:(h.areaUnitContractCarList||[]).map(r=>X(r)).slice(0,+((t==null?void 0:t.areaUnitCarsNo)||"1"))}))},[m,h,s,g,n,t==null?void 0:t.areaUnitCapacity,t==null?void 0:t.areaUnitCarsNo]),console.log(t),e.jsxs(e.Fragment,{children:[v?e.jsx(e.Fragment,{children:e.jsx("div",{className:"CompletedReservation",children:e.jsxs("div",{className:"CompletedReservationCard",children:[e.jsx("p",{children:a("booking_confirmation.letterOfConfirmation")}),e.jsxs("div",{className:"inputsContainer",children:[e.jsxs("div",{className:"inputs",children:[e.jsxs("div",{className:"flex flex-1 items-center",children:[e.jsx("label",{htmlFor:"ownerPhone",className:"mb-1 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.owner_phone")}),e.jsx(U,{id:"ownerPhone",value:`${t==null?void 0:t.beneficiaryCountryCode}${t==null?void 0:t.beneficiaryMobile}`||"",defaultCountry:"SA",className:"rtl:flex-row-reverse",international:!1,onChange:()=>{},disabled:!0,countryCallingCodeEditable:!1})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ownerName",className:"mb-1 text-sm font-medium text-gray-700 dark:text-[var(--white-color)]",children:a("booking_confirmation.owner_name")}),e.jsx("input",{id:"ownerName",className:"nameInput",type:"text",value:(t==null?void 0:t.beneficiaryName)||"",disabled:!0})]})]}),e.jsx("button",{className:"navButton",onClick:f,children:"انتقل للرئيسية"})]})]})})}):"",i==="done"?e.jsx(G,{children:e.jsx("h1",{children:a("booking_confirmation.success")})}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mb-[2rem]"}),u&&e.jsx(P,{}),!u&&e.jsx("div",{className:"booking-confirmation mt-[8rem] flex w-full flex-col items-start lg:mt-0",children:e.jsxs("form",{onSubmit:r=>{r.preventDefault(),b()},className:"container",children:[e.jsx("h1",{className:"pb-[10px] text-[2.5rem] font-bold text-[#5A4B64] dark:text-[var(--white-color)]",children:a("booking_confirmation.title")}),e.jsxs("div",{className:"py-5",children:[e.jsx("h3",{className:" text-[2rem] font-bold dark:text-[var(--white-color)]",children:a("booking_confirmation.tenant_details")}),e.jsx(K,{}),e.jsx("hr",{}),e.jsx("h3",{className:"mb-3 mt-5 text-[2rem] font-bold dark:text-[var(--white-color)]",children:a("booking_confirmation.tenant_details")}),e.jsx(J,{})]}),e.jsx("hr",{}),e.jsx(W,{}),e.jsx(H,{}),e.jsx("hr",{}),e.jsxs("div",{className:"my-[2rem] flex w-full flex-col justify-end gap-4 md:flex-row",children:[e.jsxs("div",{className:"flex flex-1 items-center",children:[e.jsxs("label",{className:"me-4 flex items-center dark:text-[var(--white-color)]",children:[e.jsx("input",{type:"checkbox",value:d?"checked":"",onChange:()=>c(r=>!r),className:"me-2 !inline-block"}),e.jsx("span",{children:a("booking_confirmation.alternatePhoneNumber")})]}),e.jsx(U,{placeholder:a("booking_confirmation.enter_phone"),value:`+${g}${s}`||"",defaultCountry:"SA",className:"rtl:flex-row-reverse",international:!1,onChange:()=>{},disabled:!d})]}),i==="error"&&e.jsx("div",{className:"flex-1 text-[1.25rem] text-red-500",children:a("booking_confirmation.error")}),e.jsxs(F,{className:"w-full md:w-[10rem]",disabled:i==="loading",type:"submit",onClick:()=>b(),children:[i==="loading"&&e.jsx("div",{className:"inline-block",children:e.jsx(q,{})}),i!=="loading"&&a("booking_confirmation.save")]})]})]})}),e.jsx($,{})]})]})};export{he as default};
